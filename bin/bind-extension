#!/usr/bin/env bash

BIN_NAME=$(basename "$0")

function usage {
    echo "Usage: $BIN_NAME [app] [extension]"
    echo "Example: MacDown .md"
    exit 1
}

if [[ "$1" == "help" ]] || [[ "$1" == "-h" ]] || [[ "$1" == "--help" ]]; then
	usage
fi

APP="$1"
EXTENSION="$2"

[[ -z "$APP" ]] && usage
[[ -z "$EXTENSION" ]] && usage

BUNDLE_ID=$(osascript -e "id of app \"$APP\"")
RETURN_CODE=$?

if [[ "$RETURN_CODE" == "1" ]]; then
    echo "App $APP not found"
    exit "$RETURN_CODE"
fi

duti -s "$BUNDLE_ID" "$EXTENSION" all
